<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Symptom Check</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #f8f9fa;
      color: #212529;
      font-family: 'Poppins', sans-serif;
    }

    /* Navbar */
    .navbar {
      background-color: #0d6efd !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
    }
    .navbar-brand { font-weight: 700; color: #fff !important; }
    .logo img { width: 50px; height: 50px; border-radius: 50%; }

    /* Main card */
    .main-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 28px;
      box-shadow: 0 6px 20px rgba(13,110,253,0.06);
      border: 1px solid #e6eefc;
    }

    .form-control { border-radius: 10px; }
    .form-control:focus { box-shadow: 0 0 0 4px rgba(13,110,253,0.08); border-color: #0d6efd; }

    .my-btn {
      width: 100%;
      padding: 12px 18px;
      border-radius: 28px;
      border: none;
      font-size: 16px;
      font-weight: 700;
      background: linear-gradient(135deg,#0d6efd,#33bfff);
      color: white;
      transition: transform .15s ease;
    }
    .my-btn:hover { transform: translateY(-3px); }

    .speech-btn {
      padding: 8px 16px;
      border-radius: 18px;
      border: none;
      background: #198754;
      color: white;
      font-weight: 700;
    }
    .speech-btn:hover { opacity: 0.95; }

    /* Result buttons ‚Äî consistent style */
    .result-btn {
      padding: 8px 18px;
      border-radius: 20px;
      border: none;
      background: linear-gradient(135deg,#0d6efd,#33bfff);
      color: #fff;
      margin: 6px;
      font-weight: 700;
      box-shadow: 0 4px 14px rgba(13,110,253,0.08);
    }
    .result-btn:hover { transform: scale(1.03); }

    /* Sections: grid layout */
    .two-col {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 20px;
      align-items: start;
    }

    /* Health tips box */
    .tips-card {
      background: linear-gradient(180deg,#ffffff,#f7fbff);
      border-radius: 12px;
      padding: 18px;
      border: 1px solid #e6eefc;
      box-shadow: 0 6px 18px rgba(0,0,0,0.03);
    }

    /* Diseases list */
    .diseases-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      border: 1px solid #e9f2ff;
      height: 460px;
      overflow: auto;
    }
    .disease-item {
      padding: 10px 12px;
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background .12s, transform .08s;
      border: 1px solid transparent;
    }
    .disease-item:hover {
      background: #f1f8ff;
      transform: translateY(-2px);
      border-color: #dbeeff;
    }

    /* Footer */
    footer {
      text-align: center;
      background: #fff;
      padding: 18px;
      color: #495057;
      margin-top: 30px;
      border-top: 1px solid #eef3fb;
    }

    /* Responsive */
    @media (max-width: 930px) {
      .two-col { grid-template-columns: 1fr; }
      .diseases-card { height: 340px; }
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-fluid">
      <div class="logo">
        <img src="{{ url_for('static', filename='heal.jpg') }}" alt="logo">
      </div>
      <a class="navbar-brand ms-3" href="#">Symptom Check</a>
    </div>
  </nav>

  <div class="container my-4">
    <h1 class="text-center mt-3" style="color:#0d6efd;">Docmeet Symptom Checker</h1>

    <div class="two-col my-4">
      <!-- Left column: main form + results + extras -->
      <div>
        <div class="main-card mb-4">
          <form action="/predict" method="post">
            <label for="symptoms" class="form-label fw-600">Enter Symptoms</label>
            <input type="text" class="form-control mb-3" id="symptoms" name="symptoms"
                   placeholder="Example: blackheads, headache, itching">

            <!-- <div class="d-flex align-items-center gap-2 mb-3">
              <button type="button" id="startSpeechRecognition" class="speech-btn">üé§ Speak Symptoms</button>
              <small class="text-muted">Use voice to fill symptoms quickly</small>
            </div> -->

            <div id="transcription" class="mb-3 text-muted"></div>

            {% if message %}
              <div class="alert alert-warning">{{ message }}</div>
            {% endif %}

            <button type="submit" class="my-btn">Predict</button>
          </form>
        </div>

        <!-- Results buttons (only visible when prediction exists) -->
        {% if predicted_disease %}
        <div class="main-card mb-4">
          <h5 class="mb-3">Results</h5>
          <div class="d-flex flex-wrap">
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#diseaseModal">Disease</button>
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#descriptionModal">Description</button>
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#precautionModal">Precaution</button>
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#medicationsModal">Medications</button>
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#workoutsModal">Workouts</button>
            <button type="button" class="result-btn" data-bs-toggle="modal" data-bs-target="#dietsModal">Diets</button>
          </div>
        </div>
        {% endif %}

        <!-- Health Tips Section -->
        <div class="tips-card mb-4">
          <h5 style="color:#0d6efd;">Health Tips</h5>
          <p class="text-muted mb-2">General preventive tips for better daily health:</p>
          <ul>
            <li>Stay hydrated ‚Äî drink at least 2‚Äì3 liters of water daily.</li>
            <li>Maintain a balanced diet with vegetables, fruits, and proteins.</li>
            <li>Get regular sleep (7‚Äì8 hours) and manage stress with short breaks.</li>
            <li>Wash hands frequently and maintain hygiene to avoid infections.</li>
            <li>Exercise regularly ‚Äî 30 minutes of moderate activity most days.</li>
            <li>If you have persistent symptoms, consult a healthcare professional.</li>
          </ul>
        </div>

        <!-- Optional: quick links / resources -->
       
      </div>

      <!-- Right column: Searchable diseases list -->
      <aside>
        <div class="diseases-card">
          <div class="d-flex mb-3 align-items-center">
            <input id="diseaseSearch" class="form-control form-control-sm me-2" placeholder="Search diseases..." />
            <button id="clearSearch" class="btn btn-sm btn-outline-secondary">Clear</button>
          </div>

          <h6 class="mb-2" style="color:#0d6efd;">Diseases List</h6>
          <p class="text-muted small mb-3">Click a disease to see quick tips or use prediction to fetch detailed info.</p>

          <div id="diseasesListContainer">
            <!-- populated by JavaScript -->
          </div>
        </div>
      </aside>
    </div>
  </div>

  <!-- MODALS (same as before; content comes from Flask variables when prediction exists) -->
  <div class="modal fade" id="diseaseModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Predicted Disease</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p>{{ predicted_disease }}</p>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="descriptionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Description</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p>{{ dis_des }}</p>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="precautionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Precautions</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul>
          {% for i in my_precautions %}<li>{{ i }}</li>{% endfor %}
        </ul>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="medicationsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Medications</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul>
          {% for i in medications %}<li>{{ i }}</li>{% endfor %}
        </ul>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="workoutsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Workouts</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul>
          {% for i in workout %}<li>{{ i }}</li>{% endfor %}
        </ul>
      </div>
    </div></div>
  </div>

  <div class="modal fade" id="dietsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title">Diets</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <ul>
          {% for i in my_diet %}<li>{{ i }}</li>{% endfor %}
        </ul>
      </div>
    </div></div>
  </div>

  <!-- Modal used by disease-list clicks -->
  <div class="modal fade" id="diseaseInfoModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog"><div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 id="diseaseInfoTitle" class="modal-title">Disease</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="diseaseInfoBody">
        <p id="diseaseInfoText"></p>
        <hr/>
        <small class="text-muted">Tip: use the Predict button with your symptoms to fetch full details (description, precautions, medications, diets, workouts).</small>
      </div>
    </div></div>
  </div>

  <footer>
    <p>¬© 2025 Symptom Checker | Designed with ‚ù§Ô∏è for Docmeet</p>
  </footer>

  <script>
    // --- Speech recognition (same behavior) ---
    document.getElementById("startSpeechRecognition").onclick = () => {
      try {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = 'en-US';
        recognition.onresult = (e) => {
          document.getElementById("symptoms").value = e.results[0][0].transcript;
          document.getElementById("transcription").textContent = "Transcribed: " + e.results[0][0].transcript;
        };
        recognition.start();
      } catch (err) {
        alert("Speech recognition is not supported in this browser.");
      }
    };

    // --- Diseases list data (copied from your backend mapping) ---
    const DISEASES = [
      "Fungal infection","Allergy","GERD","Chronic cholestasis","Drug Reaction","Peptic ulcer diseae",
      "AIDS","Diabetes","Gastroenteritis","Bronchial Asthma","Hypertension","Migraine","Cervical spondylosis",
      "Paralysis (brain hemorrhage)","Jaundice","Malaria","Chicken pox","Dengue","Typhoid","hepatitis A",
      "Hepatitis B","Hepatitis C","Hepatitis D","Hepatitis E","Alcoholic hepatitis","Tuberculosis","Common Cold",
      "Pneumonia","Dimorphic hemmorhoids(piles)","Heart attack","Varicose veins","Hypothyroidism","Hyperthyroidism",
      "Hypoglycemia","Osteoarthristis","Arthritis","(vertigo) Paroymsal  Positional Vertigo","Acne",
      "Urinary tract infection","Psoriasis","Impetigo"
    ];

    // Optional short tips for some diseases (others will show generic prompt)
    const DISEASE_TIPS = {
      "Malaria": "If you suspect malaria, get a blood test and start treatment immediately as advised by a doctor. Stay hydrated.",
      "Dengue": "Stay hydrated, monitor platelet counts, and get prompt medical care if bleeding occurs.",
      "Typhoid": "Consult a physician, antibiotics are usually required; maintain hydration and rest.",
      "Common Cold": "Rest, stay hydrated, use warm fluids; see a doctor if symptoms persist.",
      "Pneumonia": "Seek immediate medical attention; may require antibiotics or hospitalization.",
      "Diabetes": "Manage blood sugar with diet, exercise, and medication as prescribed.",
      "Hypertension": "Monitor BP regularly, reduce salt intake, exercise, and follow medical advice."
    };

    // Populate diseases list into the container
    const container = document.getElementById("diseasesListContainer");
    function renderDiseases(list) {
      container.innerHTML = "";
      if (!list.length) {
        container.innerHTML = "<p class='text-muted small'>No matches found.</p>";
        return;
      }
      for (const d of list) {
        const div = document.createElement("div");
        div.className = "disease-item";
        div.textContent = d;
        div.onclick = () => openDiseaseInfo(d);
        container.appendChild(div);
      }
    }
    renderDiseases(DISEASES);

    // Search behavior
    const searchInput = document.getElementById("diseaseSearch");
    searchInput.addEventListener("input", () => {
      const q = searchInput.value.trim().toLowerCase();
      const filtered = DISEASES.filter(d => d.toLowerCase().includes(q));
      renderDiseases(filtered);
    });
    document.getElementById("clearSearch").addEventListener("click", () => {
      searchInput.value = "";
      renderDiseases(DISEASES);
      searchInput.focus();
    });

    // Open modal showing disease info (basic tip + suggestion to predict for full details)
    function openDiseaseInfo(diseaseName) {
      const modalTitle = document.getElementById("diseaseInfoTitle");
      const modalText = document.getElementById("diseaseInfoText");

      modalTitle.textContent = diseaseName;
      if (DISEASE_TIPS[diseaseName]) {
        modalText.textContent = DISEASE_TIPS[diseaseName];
      } else {
        modalText.textContent = "Quick info not available here. Use the Predict feature with relevant symptoms to get a full description, precautions, medications, diets and workouts for " + diseaseName + ".";
      }

      // show modal
      const modalEl = new bootstrap.Modal(document.getElementById("diseaseInfoModal"));
      modalEl.show();
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
